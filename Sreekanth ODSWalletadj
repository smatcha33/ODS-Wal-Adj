----------m_Check_Latency_ODS_WALLET_ADJUSTMENT 1st session-----------

SELECT TO_CHAR(END_TIME,'YYYYMMDDHH24:MI') END_TIME FROM
(
  SELECT LEAST(t.WATERMARK, CASE WHEN $$IN_INTERVAL_MIN = 0 THEN SYSDATE() ELSE DATEADD(minute ,$$IN_INTERVAL_MIN, to_timestamp('$$START_TIME','YYYYMMDDHH24:MI')) END) END_TIME
  FROM
  (
     SELECT MIN(TO_TIMESTAMP(TO_CHAR(WATERMARK,'YYYYMMDDHH24:MI'),'YYYYMMDDHH24:MI')) WATERMARK FROM NP_SCECOMM.HEARTBEAT WHERE TABLENAME IN ('TRANSACTION','LEDGER','TRANSACTION_LEDGER','WALLET_PAYMENT','TRANSACTION_DRVNG_ST','CHARGE_REFUND')
  ) t
)
WHERE END_TIME > TO_TIMESTAMP('$$START_TIME','YYYYMMDDHH24:MI')



---------next track latency-------

SELECT 'WALLET_ADJUSTMENT' JOB_NAME,TO_TIMESTAMP('$$START_TIME','YYYYMMDDHH24:MI') START_TIME,TO_TIMESTAMP('$$END_TIME','YYYYMMDDHH24:MI')   END_TIME,
  MAX(CASE WHEN TABLENAME='TRANSACTION' then TO_TIMESTAMP(TO_CHAR(WATERMARK, 'MMDDYYYY HH24:MI:SS.FF6'), 'MMDDYYYY HH24:MI:SS.FF6') END) AS "TRANSACTION" ,
 MAX(CASE WHEN TABLENAME='TRANSACTION_DRVNG_ST' then TO_TIMESTAMP(TO_CHAR(WATERMARK, 'MMDDYYYY HH24:MI:SS.FF6'), 'MMDDYYYY HH24:MI:SS.FF6') END) AS "TRANSACTION_DRVNG_ST" ,
 MAX(CASE WHEN TABLENAME='LEDGER' then TO_TIMESTAMP(TO_CHAR(WATERMARK, 'MMDDYYYY HH24:MI:SS.FF6'), 'MMDDYYYY HH24:MI:SS.FF6') END) AS "LEDGER" ,
 MAX(CASE WHEN TABLENAME='CHARGEBACK' then TO_TIMESTAMP(TO_CHAR(WATERMARK, 'MMDDYYYY HH24:MI:SS.FF6'), 'MMDDYYYY HH24:MI:SS.FF6') END) AS "CHARGEBACK" ,
 MAX(CASE WHEN TABLENAME='CHARGE_REFUND' then TO_TIMESTAMP(TO_CHAR(WATERMARK, 'MMDDYYYY HH24:MI:SS.FF6'), 'MMDDYYYY HH24:MI:SS.FF6') END) AS "CHARGE_REFUND" ,
 MAX(CASE WHEN TABLENAME='TRANSACTION_LEDGER' then TO_TIMESTAMP(TO_CHAR(WATERMARK, 'MMDDYYYY HH24:MI:SS.FF6'), 'MMDDYYYY HH24:MI:SS.FF6') END) AS "TRANSACTION_LEDGER" ,
 MAX(CASE WHEN TABLENAME='WALLET_PAYMENT' then TO_TIMESTAMP(TO_CHAR(WATERMARK, 'MMDDYYYY HH24:MI:SS.FF6'), 'MMDDYYYY HH24:MI:SS.FF6') END) AS "WALLET_PAYMENT" ,
 MAX(CASE WHEN TABLENAME='BALANCE_ADJUSTMENT' then TO_TIMESTAMP(TO_CHAR(WATERMARK, 'MMDDYYYY HH24:MI:SS.FF6'), 'MMDDYYYY HH24:MI:SS.FF6') END) AS "BALANCE_ADJUSTMENT" 
 FROM NP_SCECOMM.HEARTBEAT WHERE TABLENAME IN ('TRANSACTION','LEDGER','TRANSACTION_LEDGER','WALLET_PAYMENT', 'TRANSACTION_DRVNG_ST','CHARGEBACK','CHARGE_REFUND','BALANCE_ADJUSTMENT');
 
 
 ------------------------2nd session-----------
 
 
 SELECT DISTINCT
       T1.TRANSACTION_ID,
       TO_TIMESTAMP(TO_CHAR(T1.TRANSACTION_DATE, 'MMDDYYYY HH24:MI:SS.FF6'), 'MMDDYYYY HH24:MI:SS.FF6') AS TRANSACTION_DATE,
       T.ACCOUNT_ID        AS T_ACCOUNT_ID,
       T1.TRANSACTION_TYPE,
       T1.LEDGER_ID         AS T_LEDGER_ID,
       T1.PLATFORM_ID       AS T_PLATFORM_ID,
       T1.DEVICE_ID         AS T_DEVICE_ID,
       T1.IP_ADDRESS        AS T_IP_ADDRESS,
       T1.ZIPCODE           AS T_ZIPCODE,
       L.LEDGER_ID,
       L.TRANSACTION_ID       AS L_TRANSACTION_ID,
       L.OWNER                AS L_OWNER,
       L.ACTOR                AS L_ACTOR,
       TO_TIMESTAMP(TO_CHAR(L.CREATION_DATE, 'MMDDYYYY HH24:MI:SS.FF6'), 'MMDDYYYY HH24:MI:SS.FF6') AS L_CREATION_DATE,
       L.LEDGER_TYPE          AS L_LEDGER_TYPE,
       L.LEDGER_STATUS        AS L_LEDGER_STATUS,
       L.CURRENCY_CODE        AS L_CURRENCY_CODE,
       L.ORDER_TOTAL          AS L_ORDER_TOTAL,
       L.PAYMENT_TOTAL        AS L_PAYMENT_TOTAL,
       L.BALANCE              AS L_BALANCE,
       L.COUNTRY_CODE         AS L_COUNTRY_CODE,      
       TO_TIMESTAMP(TO_CHAR(L.MODIFY_DATE, 'MMDDYYYY HH24:MI:SS.FF6'), 'MMDDYYYY HH24:MI:SS.FF6') AS L_MODIFY_DATE,
       CR.CHARGE_REFUND_ID,
       CR.CHARGE_PAYMENT_ID   CR_CHARGE_PAYMENT_ID,
       CR.REFUND_REASON       CR_REFUND_REASON,
       CR.REFUND_AMOUNT       CR_REFUND_AMOUNT,
       CB.CHARGEBACK_ID ,
       CB.CHARGE_PAYMENT_ID   CB_CHARGE_PAYMENT_ID,
       CB.CHARGEBACK_AMOUNT   CB_CHARGEBACK_AMOUNT,
      -1 as  CB_CHARGEBACK_NOTIFICATION_ID,
       NULL AS BALANCE_ADJUSTMENT_ID,
       NULL AS BA_AMOUNT,
       CSR.CSR_ACCOUNT_ID     CSR_ACCOUNT_ID,
	   SUBSTR(NVL(REPLACE(REPLACE(REPLACE(CSR.CSR_COMMENT, CHR(10)), CHR(13)), CHR(9)),'N/A'),1,153) AS CSR_COMMENT,
       NULL AS WALLET_PAYMENT_ID,
       NULL AS WP_AMOUNT,
       NULL AS WP_CANCELLED_FLAG,
       C.REGION               AS REGION
		FROM
       NP_SCECOMM.TRANSACTION T       
       INNER JOIN (select * from np_scecomm.transaction
       WHERE 
        TRANSACTION_DATE > to_timestamp('$$START_TIME','YYYYMMDDHH24:MI')
        AND TRANSACTION_DATE <=  to_timestamp('$$END_TIME','YYYYMMDDHH24:MI')    
        and transaction_version<2
		AND TRANSACTION_TYPE IN (10,11,12,13,23) 
        
               union
              select a.* from np_scecomm.transaction a
               inner join np_scecomm.transaction_drvng_st b
               on a.root_driving_transaction_id=b.transaction_id and state_type_id=1
                where 
               TRANSACTION_DATE > to_timestamp('$$START_TIME','YYYYMMDDHH24:MI')
               AND TRANSACTION_DATE <= to_timestamp('$$END_TIME','YYYYMMDDHH24:MI')
               AND b.MODIFY_DATE <= TO_TIMESTAMP('$$END_TIME','YYYYMMDDHH24:MI')  --added to filter STATE_TYPE_ID=0 records due to delay of data in TRANSACTION table
               AND TRANSACTION_VERSION=2 
	        AND a.TRANSACTION_TYPE IN (10,11,12,13,23) ) T1 ON T1.LEDGER_ID = T.LEDGER_ID 
       INNER JOIN NP_SCECOMM.LEDGER L ON T.LEDGER_ID=L.LEDGER_ID AND L.LEDGER_TYPE IN (1,4) AND L.TENANT_ID =1  --Vega changes 
       INNER JOIN NP_SCECOMM.COUNTRY C     ON L.COUNTRY_CODE = C.COUNTRY_CODE 
       LEFT OUTER JOIN NP_SCECOMM.CHARGEBACK CB ON T1.TRANSACTION_ID = CB.CHARGEBACK_TRANSACTION_ID 
       LEFT OUTER JOIN NP_SCECOMM.CHARGE_REFUND CR ON T1.TRANSACTION_ID = CR.REFUND_TRANSACTION_ID 
       LEFT OUTER JOIN NP_SCECOMM.CSR_COMMENTS CSR ON T1.TRANSACTION_ID = CSR.TRANSACTION_ID
       WHERE T.TRANSACTION_TYPE IN (0,13,14)
	   
	   
	   
-------------------------3rd session-------------

SELECT DISTINCT
       T1.TRANSACTION_ID,
       TO_TIMESTAMP(TO_CHAR(T1.TRANSACTION_DATE, 'MMDDYYYY HH24:MI:SS.FF6'), 'MMDDYYYY HH24:MI:SS.FF6') AS TRANSACTION_DATE,
       T.ACCOUNT_ID        AS T_ACCOUNT_ID,
       T1.TRANSACTION_TYPE,
       T1.LEDGER_ID         AS T_LEDGER_ID,
       T1.PLATFORM_ID       AS T_PLATFORM_ID,
       T1.DEVICE_ID         AS T_DEVICE_ID,
       T1.IP_ADDRESS        AS T_IP_ADDRESS,
       T1.ZIPCODE           AS T_ZIPCODE,
       L.LEDGER_ID,
       L.TRANSACTION_ID       AS L_TRANSACTION_ID,
       L.OWNER                AS L_OWNER,
       L.ACTOR                AS L_ACTOR,
       TO_TIMESTAMP(TO_CHAR(L.CREATION_DATE, 'MMDDYYYY HH24:MI:SS.FF6'), 'MMDDYYYY HH24:MI:SS.FF6') AS L_CREATION_DATE,
       L.LEDGER_TYPE          AS L_LEDGER_TYPE,
       L.LEDGER_STATUS        AS L_LEDGER_STATUS,
       L.CURRENCY_CODE        AS L_CURRENCY_CODE,
       L.ORDER_TOTAL          AS L_ORDER_TOTAL,
       L.PAYMENT_TOTAL        AS L_PAYMENT_TOTAL,
       L.BALANCE              AS L_BALANCE,
       L.COUNTRY_CODE         AS L_COUNTRY_CODE,
       TO_TIMESTAMP(TO_CHAR(L.MODIFY_DATE, 'MMDDYYYY HH24:MI:SS.FF6'), 'MMDDYYYY HH24:MI:SS.FF6') AS L_MODIFY_DATE,
       NULL AS CHARGE_REFUND_ID,
       NULL AS CR_CHARGE_PAYMENT_ID,
       NULL AS CR_REFUND_REASON,
       NULL AS CR_REFUND_AMOUNT,
       NULL AS CHARGEBACK_ID,
       NULL AS CHARGE_PAYMENT_ID,
       NULL AS CHARGEBACK_AMOUNT,
       NULL AS CHARGEBACK_NOTIFICATION_ID,
       NULL AS BALANCE_ADJUSTMENT_ID,
       NULL AS BA_AMOUNT,
       CSR.CSR_ACCOUNT_ID     CSR_ACCOUNT_ID,
       SUBSTR(NVL(REPLACE(REPLACE(REPLACE(CSR.CSR_COMMENT, CHR(10)), CHR(13)), CHR(9)),'N/A'),1,153) AS CSR_COMMENT,	   
       WP.WALLET_PAYMENT_ID          WALLET_PAYMENT_ID,	   
       WP.AMOUNT                     WP_AMOUNT,
       WP.CANCELLED_FLAG             WP_CANCELLED_FLAG,
       C.REGION               AS REGION		
       FROM
       NP_SCECOMM.TRANSACTION T       
       INNER JOIN 
	      (select * from np_scecomm.transaction
																  
            WHERE TRANSACTION_DATE > to_timestamp('$$START_TIME','YYYYMMDDHH24:MI')
            AND TRANSACTION_DATE <=  to_timestamp('$$END_TIME','YYYYMMDDHH24:MI') 
			and  transaction_version<2
		    AND TRANSACTION_TYPE IN (15) 
          union
            select a.* from np_scecomm.transaction a
            inner join np_scecomm.transaction_drvng_st b
            on a.root_driving_transaction_id=b.transaction_id and state_type_id=1
																   
            WHERE a.TRANSACTION_DATE > to_timestamp('$$START_TIME','YYYYMMDDHH24:MI')
            AND a.TRANSACTION_DATE <=  to_timestamp('$$END_TIME','YYYYMMDDHH24:MI')
            AND b.MODIFY_DATE <= TO_TIMESTAMP('$$END_TIME','YYYYMMDDHH24:MI')  --added to filter STATE_TYPE_ID=0 records due to delay of data in TRANSACTION table
            AND TRANSACTION_VERSION=2 
            AND a.TRANSACTION_TYPE IN (15) 
	   ) T1 ON T1.LEDGER_ID = T.LEDGER_ID 
       INNER JOIN NP_SCECOMM.LEDGER L ON T.LEDGER_ID=L.LEDGER_ID AND L.LEDGER_TYPE IN (1) AND L.TENANT_ID =1  --Vega changes   	   
       INNER JOIN NP_SCECOMM.COUNTRY C     ON L.COUNTRY_CODE = C.COUNTRY_CODE 
       LEFT OUTER JOIN (SELECT TLX.DRIVING_TRANSACTION_ID,TLX.TRANSACTION_ID,TLX.LEDGER_ID 
                        FROM NP_SCECOMM.Transaction_Ledger TLX,NP_SCECOMM.TRANSACTION T2 
                        WHERE T2.TRANSACTION_ID = TLX.TRANSACTION_ID  
                        AND T2.TRANSACTION_TYPE IN (32))  TL
                        ON  TL.DRIVING_TRANSACTION_ID = T1.TRANSACTION_ID AND TL.LEDGER_ID = T1.LEDGER_ID 
                        AND TL.TRANSACTION_ID <> T1.TRANSACTION_ID 
       LEFT OUTER JOIN NP_SCECOMM.WALLET_PAYMENT WP ON TL.TRANSACTION_ID = WP.TRANSACTION_ID       
       LEFT OUTER JOIN NP_SCECOMM.CSR_COMMENTS CSR ON T1.TRANSACTION_ID = CSR.TRANSACTION_ID
       WHERE T.TRANSACTION_TYPE IN (0,13,14)
	   
---------------------4th session-------------


SELECT DISTINCT
       T1.TRANSACTION_ID,
       TO_TIMESTAMP(TO_CHAR(T1.TRANSACTION_DATE, 'MMDDYYYY HH24:MI:SS.FF6'), 'MMDDYYYY HH24:MI:SS.FF6') AS TRANSACTION_DATE,
       T.ACCOUNT_ID        AS T_ACCOUNT_ID,
       T1.TRANSACTION_TYPE,
       T1.LEDGER_ID         AS T_LEDGER_ID,
       T1.PLATFORM_ID       AS T_PLATFORM_ID,
       T1.DEVICE_ID         AS T_DEVICE_ID,
       T1.IP_ADDRESS        AS T_IP_ADDRESS,
       T1.ZIPCODE           AS T_ZIPCODE,
       L.LEDGER_ID,
       L.TRANSACTION_ID       AS L_TRANSACTION_ID,
       L.OWNER                AS L_OWNER,
       L.ACTOR                AS L_ACTOR,
       TO_TIMESTAMP(TO_CHAR(L.CREATION_DATE, 'MMDDYYYY HH24:MI:SS.FF6'), 'MMDDYYYY HH24:MI:SS.FF6') AS L_CREATION_DATE,
       L.LEDGER_TYPE          AS L_LEDGER_TYPE,
       L.LEDGER_STATUS        AS L_LEDGER_STATUS,
       L.CURRENCY_CODE        AS L_CURRENCY_CODE,
       L.ORDER_TOTAL          AS L_ORDER_TOTAL,
       L.PAYMENT_TOTAL        AS L_PAYMENT_TOTAL,
       L.BALANCE              AS L_BALANCE,
       L.COUNTRY_CODE         AS L_COUNTRY_CODE,      
       TO_TIMESTAMP(TO_CHAR(L.MODIFY_DATE, 'MMDDYYYY HH24:MI:SS.FF6'), 'MMDDYYYY HH24:MI:SS.FF6') AS L_MODIFY_DATE,
       NULL AS CHARGE_REFUND_ID,
       NULL AS CR_CHARGE_PAYMENT_ID,
       NULL AS CR_REFUND_REASON,
       NULL AS CR_REFUND_AMOUNT,
       NULL AS CHARGEBACK_ID,
       NULL AS CHARGE_PAYMENT_ID,
       NULL AS CHARGEBACK_AMOUNT,
       NULL AS CHARGEBACK_NOTIFICATION_ID,
       BA.BALANCE_ADJUSTMENT_ID      BALANCE_ADJUSTMENT_ID,
       BA.AMOUNT                     BA_AMOUNT,
       CSR.CSR_ACCOUNT_ID     CSR_ACCOUNT_ID,
	   SUBSTR(NVL(REPLACE(REPLACE(REPLACE(CSR.CSR_COMMENT, CHR(10)), CHR(13)), CHR(9)),'N/A'),1,153) AS CSR_COMMENT,
       NULL AS WALLET_PAYMENT_ID,
       NULL AS WP_AMOUNT,
       NULL AS WP_CANCELLED_FLAG,
       C.REGION               AS REGION
		FROM
       NP_SCECOMM.TRANSACTION T       
       INNER JOIN (select * from np_scecomm.transaction
       WHERE 
        TRANSACTION_DATE > to_timestamp('$$START_TIME','YYYYMMDDHH24:MI')
        AND TRANSACTION_DATE <=  to_timestamp('$$END_TIME','YYYYMMDDHH24:MI')  +  INTERVAL '1 min'
        and transaction_version<2
	    AND TRANSACTION_TYPE IN (14,21) 
        
               union
              select a.* from np_scecomm.transaction a
               inner join np_scecomm.transaction_drvng_st b
               on a.root_driving_transaction_id=b.transaction_id and state_type_id=1
                where 
               TRANSACTION_DATE > to_timestamp('$$START_TIME','YYYYMMDDHH24:MI')
               AND TRANSACTION_DATE <= to_timestamp('$$END_TIME','YYYYMMDDHH24:MI') 
               AND b.MODIFY_DATE <= TO_TIMESTAMP('$$END_TIME','YYYYMMDDHH24:MI')  --added to filter STATE_TYPE_ID=0 records due to delay of data in TRANSACTION table
               AND TRANSACTION_VERSION=2 
	        AND a.TRANSACTION_TYPE IN (14,21) ) T1 ON T1.LEDGER_ID = T.LEDGER_ID
       INNER JOIN NP_SCECOMM.LEDGER L ON T.LEDGER_ID=L.LEDGER_ID AND L.LEDGER_TYPE IN (1,4,5,6)
                  AND L.TENANT_ID =1  --Vega changes 
       INNER JOIN NP_SCECOMM.COUNTRY C     ON L.COUNTRY_CODE = C.COUNTRY_CODE 
       LEFT OUTER JOIN NP_SCECOMM.Transaction_Ledger TL ON  TL.DRIVING_TRANSACTION_ID = T1.TRANSACTION_ID AND TL.LEDGER_ID = T1.LEDGER_ID 
                                                         AND TL.TRANSACTION_ID <> T1.TRANSACTION_ID AND T.TRANSACTION_TYPE NOT IN (15)            
       LEFT OUTER JOIN NP_SCECOMM.BALANCE_ADJUSTMENT BA ON TL.TRANSACTION_ID = BA.TRANSACTION_ID 
       LEFT OUTER JOIN NP_SCECOMM.CSR_COMMENTS CSR ON T1.TRANSACTION_ID = CSR.TRANSACTION_ID
       WHERE T.TRANSACTION_TYPE IN (0,13,14)
	   
----------------5th session---------------------------------

SELECT TRANSACTION_ID,TRANSACTION_DATE,T_ACCOUNT_ID,TRANSACTION_TYPE,T_LEDGER_ID,T_PLATFORM_ID,T_DEVICE_ID,T_IP_ADDRESS,T_ZIPCODE,LEDGER_ID,L_TRANSACTION_ID,L_OWNER,L_ACTOR,L_CREATION_DATE,LEDGER_TYPE,LEDGER_STATUS,L_CURRENCY_CODE,L_ORDER_TOTAL,L_PAYMENT_TOTAL,L_BALANCE,L_COUNTRY_CODE,L_MODIFY_DATE,CHARGE_REFUND_ID,CR_CHARGE_PAYMENT_ID,CR_REFUND_REASON,CR_REFUND_AMOUNT,CHARGEBACK_ID,CB_CHARGE_PAYMENT_ID,CB_CHARGEBACK_AMOUNT,-1 as CHARGEBACK_NOTIFICATION_ID,  ---Chargeback id has hardcoded -1,
BALANCE_ADJUSTMENT_ID,BA_AMOUNT,CSR_ACCOUNT_ID,CSR_COMMENT,WALLET_PAYMENT_ID,WP_AMOUNT,WP_CANCELLED_FLAG,REGION
from WHS_BI.T_ODS_WALLET_ADJUSTMENT_TRANS T		   
where TRANSACTION_ID NOT IN 
   (  select distinct TRANSACTION_ID
      FROM WHS_BI.ODS_WALLET_ADJUSTMENT OWA
      WHERE OWA.TRANSACTION_ID = T.TRANSACTION_ID
      AND 
     (OWA.TRANSACTION_DATE >= TO_TIMESTAMP('$$START_TIME','YYYYMMDDHH24:MI') - INTERVAL '1 day')
   )
   
-------------------------6th sesion-----------------
SELECT t.transaction_id id
FROM (select * from np_scecomm.transaction
                where TRANSACTION_DATE >= to_timestamp('$$MIN_TRANS_DATE','YYYYMMDDHH24:MI')
        AND TRANSACTION_DATE <to_timestamp('$$MAX_TRANS_DATE','YYYYMMDDHH24:MI')  and  transaction_version<2
               union
              select a.* from np_scecomm.transaction a
               inner join np_scecomm.transaction_drvng_st b
               on a.root_driving_transaction_id=b.transaction_id and state_type_id=1
                where TRANSACTION_DATE >= to_timestamp('$$MIN_TRANS_DATE','YYYYMMDDHH24:MI')
        AND TRANSACTION_DATE <to_timestamp('$$MAX_TRANS_DATE','YYYYMMDDHH24:MI')
               and transaction_version=2) t 
INNER JOIN NP_SCECOMM.LEDGER L ON T.LEDGER_ID = L.LEDGER_ID  
LEFT OUTER JOIN WHS_BI.ODS_WALLET_ADJUSTMENT w
ON t.transaction_id = w.transaction_id
WHERE t.transaction_date >= TO_TIMESTAMP('$$MIN_TRANS_DATE','YYYYMMDDHH24:MI')
AND t.transaction_date < TO_TIMESTAMP('$$MAX_TRANS_DATE','YYYYMMDDHH24:MI')          
AND t.transaction_type  in (10,11,12,13,14,15,21,23)
AND L.LEDGER_TYPE IN (1,4,5,6)
AND w.transaction_id is NULL and t.transaction_id not in (406091888813,418591603869,408481101346,411152352453,413451517640,421786576846,411314668847,419241862942,423174288814,421387814764,424272362442,421338874175,422643641938,425546717629,413596294450,435419872624,429848518891,429473028055,429848595668,429649380079,428068403524,417427596808,430353139537,419909017676,434229226453,444576448603,444741888647,434129280548,434668237109,434668281964,438585050002,434903731706,435641485143,435762886936,449363296652,449788634299,442185482439,442185360897,442747216845,443177168846,443746749613,426674944022,453725203878,427682054423,429041702423,429407193626,456256576678,447742666474,429406828839,456257255015,429407078414,447742397697,457232186213,448703082449,448703012003,430059891232,431581254444,431581228876,431785836810,451927690497,433376096016,462344551058,453817648802,453817648802,462344551058,433376096016,435041760031,435413331260,456706493660)
--AND L.TENANT_ID =1 and l.ledger_type <> (case when t.transaction_type =11 then 5 else 99999 end )
--Vega changes






 
